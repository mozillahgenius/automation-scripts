# Google Drive 共有ドライブ階層構造可視化ツール（GAS版）

Google Driveの共有ドライブまたはマイドライブ内のフォルダ階層とファイルを抽出し、スプレッドシートに視覚的に出力するGoogle Apps Scriptです。

## セットアップ

### 1. スプレッドシートを作成
新しいGoogleスプレッドシートを作成します。

### 2. Apps Scriptを開く
メニューから「拡張機能」→「Apps Script」を選択します。

### 3. コードを貼り付け
`Code.gs` の内容をすべてコピーして貼り付け、保存します。

### 4. Drive APIを有効化
1. Apps Scriptエディタの左側メニューで「サービス」の「+」をクリック
2. 「Drive API」を選択して「追加」をクリック

### 5. setup関数を実行
1. 関数選択で **「setup」** を選び、実行ボタンをクリック
2. 権限の承認を求められるので許可します
3. セットアップ完了のダイアログが表示されます
4. スプレッドシートに「ドライブ構造」メニューが追加されます

## 使い方

スプレッドシートのメニューから:

- **「ドライブ構造」→「共有ドライブを選択」**
  - アクセス可能な共有ドライブ一覧が表示されます
  - 処理したいドライブを選択して「構造を取得」をクリック

- **「ドライブ構造」→「マイドライブを処理」**
  - マイドライブ内のファイル構造を取得します

## 出力内容

| 列 | 内容 |
|---|---|
| 階層 | フォルダの深さ（0から） |
| 名前 | ファイル/フォルダ名（階層に応じてインデント） |
| 種別 | フォルダ / ファイル |
| カテゴリ | ファイルの種類（Google Docs, PDF, 画像など） |
| 拡張子 | ファイルの拡張子 |
| サイズ | ファイルサイズ |
| 作成日 | 作成日 |
| 更新日 | 最終更新日 |
| パス | フルパス |

## 対応ファイル形式

- **Google形式**: Docs, Sheets, Slides, Forms, Drawing, Sites, Maps
- **ドキュメント**: PDF, Word (doc/docx), テキスト
- **スプレッドシート**: Excel (xls/xlsx), CSV
- **プレゼンテーション**: PowerPoint (ppt/pptx)
- **画像**: JPEG, PNG, GIF, SVG, WebP, BMP, TIFF, HEIC
- **動画**: MP4, MOV, AVI, MKV, WebM, MPEG, 3GPP
- **音声**: MP3, WAV, AAC, FLAC, M4A
- **アーカイブ**: ZIP, TAR, GZ, RAR, 7z
- **コード**: JavaScript, TypeScript, Python, Java, HTML, CSS, JSON

## 機能

- カテゴリ別の色分け表示
- ヘッダー行の固定
- フィルター機能
- 階層をインデントで視覚化

## 注意事項

- 共有ドライブはGoogle Workspaceアカウントでのみ利用可能です
- ファイル数が多い場合、処理に時間がかかることがあります
- 実行時間制限（6分）を超える大規模なドライブは処理できない場合があります
