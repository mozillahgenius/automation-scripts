# Google Meet 議事録自動化システム セットアップ手順書

## 1. 前提条件

### 必要なアカウント・権限
- Google Workspace の有料プラン（Business Standard 以上）
- Google Cloud Platform (GCP) アカウント
- GCP プロジェクトの作成・管理権限
- Google Apps Script の実行権限

### 必要な設定
- Google Meet の録画機能が有効
- Google Meet のトランスクリプト機能が有効

## 2. GCP プロジェクトの設定

### 2.1 GCP プロジェクトの作成
1. [Google Cloud Console](https://console.cloud.google.com/) にアクセス
2. 新しいプロジェクトを作成（または既存プロジェクトを選択）
3. プロジェクト ID をメモ（後で使用）

### 2.2 必要なAPIの有効化
以下のAPIを有効化してください：

```bash
# Cloud Console で以下のAPIを有効化
- Vertex AI API
- Google Meet API (Admin SDK)
- Google Calendar API
- Gmail API
- Google Sheets API
- Google Drive API
```

手順：
1. GCP Console → API とサービス → ライブラリ
2. 上記の各APIを検索して有効化

### 2.3 IAM権限の設定
実行するユーザーアカウントに以下のロールを付与：
- `Vertex AI User`
- `Project Viewer`

## 3. Google Apps Script プロジェクトの作成

### 3.1 新規プロジェクト作成
1. [Google Apps Script](https://script.google.com/) にアクセス
2. 「新しいプロジェクト」をクリック
3. プロジェクト名を「議事録自動化システム」に変更

### 3.2 ファイルのアップロード
以下のファイルをプロジェクトに追加：

1. **Code.gs** - メインスクリプトファイル
2. **appsscript.json** - マニフェストファイル

手順：
1. 既存の「コード.gs」を削除
2. 「ファイル」→「新規」→「スクリプト」で Code.gs を作成
3. 提供されたコードをコピー＆ペースト
4. 「プロジェクトの設定」→「appsscript.json マニフェスト ファイルをエディタで表示する」をチェック
5. appsscript.json ファイルの内容を置き換え

### 3.3 設定値の更新
Code.gs ファイルの以下の定数を実際の値に変更：

```javascript
// 設定用スプレッドシートID（手順4で作成）
const CONFIG_SPREADSHEET_ID = 'YOUR_CONFIG_SPREADSHEET_ID';

// GCP設定
const GCP_PROJECT_ID = 'your-gcp-project-id';
const GCP_REGION = 'asia-northeast1';  // 必要に応じて変更
```

## 4. 設定用スプレッドシートの作成

### 4.1 新規スプレッドシート作成
1. [Google Sheets](https://sheets.google.com/) で新規スプレッドシートを作成
2. 名前を「議事録自動化_設定」に変更
3. スプレッドシート ID をメモ（URLの `/d/` と `/edit` の間の文字列）

### 4.2 設定シートの作成
1. シート名を「設定」に変更
2. A列にキー、B列に値を入力：

| A列（キー） | B列（値） |
|------------|-----------|
| CalendarId | your-calendar-id@group.calendar.google.com |
| AdditionalRecipients | manager@example.com, team@example.com |
| CheckHours | 1 |
| MinutesPrompt | （後述のプロンプトをコピー） |

### 4.3 実行ログシートの作成
1. 新しいシートを追加
2. シート名を「実行ログ」に変更
3. 1行目にヘッダーを入力：

| A列 | B列 | C列 | D列 | E列 |
|-----|-----|-----|-----|-----|
| CalendarEventID | ProcessedAt | Status | ErrorMessage | MeetingTitle |

### 4.4 MinutesPrompt の設定
B4セルに以下のプロンプトを設定：

```
# 役割
あなたは、プロの書記です。

# 指示
以下の会議トランスクリプトを読み、下記のフォーマットに従って簡潔で分かりやすい日本語の議事録を作成してください。

# フォーマット
## 1. 会議の概要
- **会議名**: (会議のタイトルを記載)
- **日時**: (YYYY/MM/DD HH:MM)
- **参加者**: (参加者名を「、」で区切って列挙)

## 2. 決定事項
- (決定したことを箇条書きで記載)
- (複数ある場合は全て記載)

## 3. アクションアイテム
- **担当者名**: (タスク内容を具体的に記載) (期限: YYYY/MM/DD)
- (複数ある場合は全て記載)

## 4. 議論内容の要約
- (主要な議題や議論の流れを箇条書きで要約)

# 制約
- トランスクリプトに存在しない情報は記載しないでください。
- 各項目で記載することがない場合は、「特になし」と記載してください。
- 参加者名は敬称を省略してください。

# 会議トランスクリプト
---
{transcript_text}
```

## 5. 権限とスコープの設定

### 5.1 初回実行と権限許可
1. Apps Script エディタで `main` 関数を選択
2. 「実行」ボタンをクリック
3. 権限の確認画面で「許可を確認」をクリック
4. Google アカウントを選択
5. 「詳細」→「議事録自動化システム（安全ではないページ）に移動」をクリック
6. 「許可」をクリック

### 5.2 Meet API の権限設定
1. [Google Admin Console](https://admin.google.com/) にアクセス（管理者権限が必要）
2. セキュリティ → API の制御 → ドメイン全体の委任
3. Apps Script プロジェクトのクライアント ID を追加
4. スコープに `https://www.googleapis.com/auth/meetings.space.readonly` を追加

## 6. トリガーの設定

### 6.1 自動実行トリガーの作成
Apps Script エディタで以下の関数を一度実行：

```javascript
setupTriggers()
```

または手動で設定：
1. Apps Script エディタで「トリガー」をクリック
2. 「トリガーを追加」をクリック
3. 以下を設定：
   - 実行する関数: `main`
   - 実行のタイミング: 時間ベース
   - 時間の間隔: 1時間おき

## 7. 初期設定の完了確認

### 7.1 設定シートの初期化
Apps Script エディタで以下の関数を実行：

```javascript
initializeConfigSheet()
```

### 7.2 テスト実行
1. Google Meet で録画・トランスクリプト有効な会議を実施
2. 会議終了後、数分待機
3. Apps Script エディタで `main` 函数を手動実行
4. 実行ログシートで結果を確認
5. 指定したメールアドレスに議事録が送信されることを確認

## 8. 運用時の注意事項

### 8.1 監視項目
- 実行ログシートで処理状況を定期確認
- エラーが発生している場合は原因を調査

### 8.2 設定変更
- カレンダー ID やメール宛先は設定シートで変更可能
- プロンプトも設定シートで調整可能

### 8.3 コスト管理
- Vertex AI の使用量を GCP Console で監視
- 無料枠を超える場合は課金が発生

### 8.4 トラブルシューティング
- トランスクリプトが取得できない → 会議の録画・トランスクリプト設定を確認
- 権限エラー → Admin Console でのAPI権限設定を確認
- メール送信エラー → Gmail の送信制限を確認

## 9. セキュリティ対策

### 9.1 アクセス制御
- Apps Script プロジェクトの共有設定を制限
- 設定スプレッドシートのアクセス権限を最小限に

### 9.2 データ保護
- 機密情報を含む会議のトランスクリプト取得を制御
- 実行ログの定期的なクリーンアップ

### 9.3 定期レビュー
- 月次でシステムの動作状況を確認
- 四半期でセキュリティ設定を見直し

## 10. サポート・参考資料

### 公式ドキュメント
- [Google Apps Script](https://developers.google.com/apps-script)
- [Google Meet API](https://developers.google.com/meet)
- [Vertex AI API](https://cloud.google.com/vertex-ai/docs)
- [Google Calendar API](https://developers.google.com/calendar)

### よくある質問
**Q: トランスクリプトが取得できません**
A: 会議終了後、数分〜十数分待ってから再実行してください。Meet API でのトランスクリプト生成には時間がかかります。

**Q: 議事録の品質を向上させたい**
A: 設定シートの MinutesPrompt を調整してください。より具体的な指示や例を追加することで改善できます。

**Q: コストを抑えたい**
A: CheckHours を調整して処理対象の会議数を制限、またはプロンプトを短縮してトークン数を削減してください。

---

このセットアップ手順書に従って設定することで、Google Meet の議事録自動化システムを運用開始できます。
