# Slack チャンネル自動作成 スクリプト

Google スプレッドシートのE列に値を入力すると、自動でSlackチャンネルを作成します。
日本語のチャンネル名にも対応しています。

## 必要な権限

Slack Appに以下の権限（OAuth Scope）が必要です：

- `channels:write` - パブリックチャンネルの作成

## セットアップ手順

### 1. Slack App の権限確認

1. [Slack API](https://api.slack.com/apps) にアクセス
2. 使用するAppを選択
3. **OAuth & Permissions** を開く
4. **Bot Token Scopes** に `channels:write` があることを確認
5. なければ追加して、ワークスペースに再インストール
6. **Bot User OAuth Token**（`xoxb-`で始まる）をコピー

### 2. Google Apps Script の設定

1. スプレッドシートを開く
2. メニュー → **拡張機能** → **Apps Script** を選択
3. `Code.gs` の内容をコピー＆ペースト
4. 保存（Ctrl+S / Cmd+S）

### 3. トークンの設定

1. Apps Script エディタで関数選択ドロップダウンから `setSlackToken` を選択
2. **実行** ボタンをクリック
3. 初回は認証を求められるので許可
4. ダイアログにBot Token（`xoxb-...`）を入力

### 4. トリガーの設定

1. 関数選択で `createEditTrigger` を選択
2. **実行** をクリック
3. 「編集トリガーを設定しました」と表示されればOK

### 5. シート名の確認

デフォルトでは「チャンネル名」というシートを対象にしています。
シート名が異なる場合は、`Code.gs` の以下の行を変更：

```javascript
const TARGET_SHEET_NAME = 'チャンネル名';
```

## 使い方

1. 対象シートのE列にチャンネル名を入力
2. 自動でSlackチャンネルが作成される
3. F列に結果が表示される
   - `✓ 作成完了: チャンネル名` - 成功
   - `✗ エラー: メッセージ` - 失敗

## チャンネル名のルール

入力した名前は自動で以下の処理が行われます：

- 英字は小文字に変換
- スペースはハイフン（-）に変換
- 日本語（ひらがな・カタカナ・漢字）はそのまま使用可能
- 80文字を超える場合は切り詰め

### 例

| 入力 | 作成されるチャンネル名 |
|------|------------------------|
| 開発チーム | 開発チーム |
| Sales Team | sales-team |
| プロジェクト A | プロジェクト-a |
| 2024年度予算 | 2024年度予算 |

## トラブルシューティング

### 「エラー: トークン未設定」

→ `setSlackToken` を実行してトークンを設定

### 「エラー: このチャンネル名は既に使用されています」

→ 同名のチャンネルが既に存在。別の名前を使用

### 「エラー: 必要な権限がありません」

→ Slack Appに `channels:write` 権限を追加して再インストール

### 何も起こらない

→ `createEditTrigger` を再実行してトリガーを設定

## テスト方法

手動でチャンネル作成をテストできます：

1. `testCreateChannel` 関数を実行
2. チャンネル名を入力
3. 結果を確認

## 設定のカスタマイズ

`Code.gs` の先頭で以下の設定を変更できます：

```javascript
// 対象のシート名
const TARGET_SHEET_NAME = 'チャンネル名';

// 対象の列（E列 = 5）
const TARGET_COLUMN = 5;

// ステータス列（F列 = 6）
const STATUS_COLUMN = 6;
```
