	1.	議題
部署別 Google スライドテンプレートに、社員名簿（スプレッドシート）情報を差し込み、自動生成したスライドを、対象社員のメールアドレス宛てに「Google ドライブの共有招待メール」として送信する GAS 仕様。

⸻

	2.	提案概要

	•	共有フォルダ配下に部署別のスライドテンプレートを配置。
	•	スプレッドシート上に
	•	Config シート（共通設定）
	•	TemplateMapping シート（部署 → テンプレートID）
	•	Employees シート（社員名簿＋生成結果）
を定義。
	•	GAS は Employees シートの各行について、部署に紐づくテンプレートからスライドをコピーし、{{}} プレースホルダを社員情報で置換。
	•	生成されたスライドを、社員のメールアドレスに対して Drive 権限付与（reader / viewer）＋通知メール送信（招待メール）する。

⸻

	3.	現在の状況・経緯

	•	すでに「部署別に若干異なるフォーマットの Google スライド」を運用する構想がある。
	•	社員名簿はスプレッドシートで管理されており、社員名・部署・役職・メールアドレス等が取得可能。
	•	要件追加：
	•	生成したスライドを、対象社員のメールアドレス宛に共有招待（Google 公式の共有通知メール）で送信したい。

⸻

	4.	目的・方針との関連（メリット・デメリット）

	•	目的
	•	スライド自動生成と同時に共有招待まで完結させ、人手による共有作業をゼロにする。
	•	共有手続きもコード化し、運用者の操作は「スクリプト実行」のみとする。

項目	メリット	デメリット
ドライブ共有招待	Google 標準の招待メールが送られ、権限付与も自動化	招待メールの件名・本文は Google 標準のため、細かいカスタマイズは不可
スプレッドシート一元管理	メールアドレス・部署・テンプレ紐づけを全てシート上で管理可能	シートの整合性が崩れると共有処理も失敗する


⸻

	5.	数値的・論理的な分析（定量・定性）

	•	手動共有の場合：
	•	各スライド生成後、Drive 画面を開き、メールアドレスを入力して共有 → 1 人あたり 1〜2 分程度。
	•	GAS で共有まで自動化した場合：
	•	追加コストはスクリプト内の Drive API 呼び出しのみで、人手工数は変わらない（実行ボタンを押すだけ）。

論理関係：
	•	社員 i に対する処理フロー
	•	入力：
	•	e_i = 社員 i のメールアドレス
	•	d_i = 社員 i の部署
	•	テンプレ取得：
	•	t_i = f(d_i) （TemplateMapping シートに対するルックアップ）
	•	スライド生成：
	•	s_i = g(t_i, \text{社員情報}) （テンプレ t_i にプレースホルダ置換を適用したプレゼン）
	•	共有招待：
	•	Drive Permissions で s_i に対し、ユーザー e_i に role = reader を付与し、sendNotificationEmail = true

⸻

	6.	得られる効果（式・期間・インパクト）

	•	追加要件（共有招待）により削減される工数：
	•	1 人あたり 1 分 × N 人分の「共有操作」が不要。
	•	年間削減時間（例：社員 50 人、年 4 回更新）：
	•	1\text{min} \times 50 \times 4 = 200\text{min} \approx 3.3\text{h/年}
	•	自動共有により、共有漏れ・権限設定ミスのリスクを低減。

⸻

	7.	他の選択肢／類似手法との比較

案	共有方法	メリット	デメリット
A	スクリプトは生成のみ、人が手動で共有	実装は簡単	人手工数・共有漏れリスクが残る
B	MailApp で URL をメール送信（リンク共有のみ）	メール本文を自由にカスタマイズ可能	Drive 上の共有権限は別途設定が必要／閲覧不可の可能性
C（採用案）	Drive API（Advanced Drive Service）で権限付与＋sendNotificationEmail	Google 標準の「共有招待」メールで確実に権限付与	招待メールの文面はカスタマイズ不可／Advanced Service 有効化が必要

採用案：C（Advanced Drive Service を利用した Drive 共有招待メール）。

⸻

	8.	アクションプラン（5W1H＋SMART）

※プラン策定の詳細は不要との前提のため、実装に直結する粒度で簡略記載。
	•	What
	•	社員名簿をもとにスライド生成および Drive 共有招待を自動実行する GAS を実装。
	•	Who
	•	GAS 実装・保守担当：情報システム／エンジニア。
	•	Where
	•	対象スプレッドシートにコンテナバインドでスクリプトを配置。
	•	When
	•	手動実行（メニュー）を基本とし、必要に応じてタイムトリガーを設定。
	•	How
	•	SlidesApp + DriveApp + Advanced Drive Service（Drive API v3）を使用。
	•	SMART
	•	Specific：Employees シートの「未処理」行に対してのみスライド生成＋共有。
	•	Measurable：生成スライド URL と共有ステータスをシートに書き戻す。
	•	他の要素は本仕様では省略。

⸻

	9.	評価基準・期間

	•	本仕様は実装単位の仕様であり、評価は以下の観点で行う。
	•	スクリプト実行後、Employees シートの対象行すべてに
	•	生成スライド URL が記録されていること。
	•	Drive の共有設定に社員メールアドレスが追加されていること。
	•	対象社員に Google 共有招待メールが届いていること。

評価期間自体の策定は本仕様の範囲外。

⸻

	10.	失敗時の撤退策

	•	Drive API/Advanced Service の利用が組織ポリシー上 NG の場合：
	•	案 B（MailApp でリンク送付＋newFile.addViewer(email) を併用）への切替。
	•	メール招待が不要になった場合：
	•	共有招待部分の呼び出しをコメントアウトし、スライド生成のみ運用。

⸻

	11.	契約・実施条件

	•	技術的前提条件
	•	GAS 実行ユーザーは、
	•	対象スプレッドシートの編集権限
	•	テンプレートスライドファイルの閲覧・コピー権限
	•	出力フォルダへのファイル作成権限
を持つこと。
	•	Advanced Google Services にて「Drive API」を有効化し、GCP 側の Drive API も有効であること。
	•	シート仕様
	1.	Config シート
	•	A1: Key, B1: Value
	•	A2: OUTPUT_FOLDER_ID, B2: 出力先フォルダ ID
	2.	TemplateMapping シート

A列	B列
部署名	テンプレートスライドID

	3.	Employees シート

列名例	内容
社員ID	任意のID
氏名	社員氏名
部署	テンプレ判定用部署名
役職	差し込み用役職
メール	共有招待先メールアドレス
ステータス	未処理 / 完了 / エラー: ...
生成スライドURL	生成されたスライドの URL



⸻

	12.	想定リスクと対策

リスク	内容	対策
メールアドレス不正	社員メールアドレスが空／形式不正で共有失敗	メール列が空または形式不正の場合、その行はスキップしステータスにエラーを記録
Advanced Service 設定不備	Drive API が有効化されておらず、権限付与でエラー	初回デプロイ前に管理者が Drive API の有効化手順を実施し、テスト行で確認
部署とテンプレ紐づけ不備	TemplateMapping に部署名が存在せずテンプレ取得失敗	例外発生時にステータスに エラー: mapping not found を記録し、マスタ修正を促す
共有権限の過不足	editor を付与しすぎる／viewer で編集できないなど	本仕様では role = reader を原則とし、変更時は仕様改訂を前提とする


⸻

	13.	その他考慮事項

	•	プレースホルダ仕様
	•	スライド側：{{NAME}}, {{DEPARTMENT}}, {{TITLE}}, {{EMAIL}} 等、英大文字＋{{}} で統一。
	•	シートの列名とプレースホルダの対応表は別途「仕様補足」シートとして管理してもよい。
	•	配布対象の拡張
	•	必要に応じて、Employees シートに「上長メール」「人事メール」列を追加し、複数メールアドレスに対して権限付与する拡張も可能。

⸻

	14.	思考プロセスと判断基準

	•	要件は「プラン策定」ではなく「仕様レベルでの確定」が目的であるため、
	•	業務フローの抽象化ではなく、
	•	シート構造・テンプレ構造・GAS の処理単位・Drive API の利用方法、に焦点を置いて整理。

判断基準：
	1.	メンテナンスコスト最小化
	•	テンプレID・部署マッピング・出力先フォルダはすべてシート管理し、コードは極力汎用化。
	2.	権限と招待メールの一体化
	•	「メール招待で共有」の要件を満たすため、Drive 権限付与＋通知メールを一体で行う Drive API 案を採用。
	3.	エラー時の可観測性
	•	全てのエラーは Employees シートのステータス列に書き戻し、人手によるリカバリを容易にする。

⸻

参考：共有招待部分の処理イメージ（GAS）

仕様理解のための参考コード断片です（実装時はエラーハンドリング等を追加）。

// Advanced Drive Service (Drive API v3) を有効化している前提
function shareWithNotification(fileId, email) {
  const resource = {
    role: 'reader',          // or 'writer'
    type: 'user',
    emailAddress: email,
  };
  Drive.Permissions.create(resource, fileId, {
    sendNotificationEmail: true,
  });
}

メイン処理側では、スライド生成後に shareWithNotification(newFileId, employeeEmail) を呼び出す。
これにより、対象社員に対して Google 標準の共有招待メールが送信される。