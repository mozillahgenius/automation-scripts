議事録作成・承認ワークフロー 仕様書（GAS＋Sheets＋Docs）

0. 目的・スコープ
	•	目的：監査等委員会／取締役会（含む書面決議）の議事録を、自社フォーマットで一元作成し、承認・リマインド・記録までを Google スプレッドシート／Google ドキュメント／GAS で完結させる。
	•	スコープ：
	•	Docsテンプレート管理、テンプレ選択によるドラフト生成
	•	HTML入力（議案案）→ AI整形 → ドキュメント差し込み
	•	議案の段階追加（議案1→2→3…の追記運用）
	•	添付資料有無の選択・記録
	•	承認者設定／承認状況可視化／未承認者への自動リマインド
	•	承認結果のドキュメント反映、監査性確保（ログ・版管理）

※Googleドキュメント標準の「承認(Approvals)」UIは並行運用してもよいが、通知・集計・自動化は本仕様の承認トラッカーで担う（API非依存のため）。

⸻

1. 役割と権限（最小構成）
	•	管理者（Admin）：テンプレ登録、会議種別設定、承認フロー設計、リマインド運用設定の変更
	•	作成者（Editor）：スプレッドシートUIからドラフト生成、議案追加、承認者の割当
	•	承認者（Approver）：通知から承認／却下（理由入力可）、期限遵守
	•	閲覧者（Viewer）：最終版閲覧のみ（編集不可）

⸻

2. システム構成（ツール＆データ）

2.1 Googleドキュメント（テンプレ）
	•	会議種別ごとにテンプレ文書を登録（例：監査等委員会／取締役会／取締役会(書面)）。
	•	プレースホルダ設計例：
	•	ヘッダ系：{{MEETING_TYPE}}, {{MEETING_DATE}}, {{LOCATION}}, {{CHAIR}}, {{ATTENDEES}}, {{ABSENTEES}}
	•	議案差し込み：{{MOTIONS_BLOCK}}（議案テーブルや見出しブロックを差し込む）
	•	承認記録：{{APPROVALS_TABLE}}
	•	書式・表紙・脚注（社名・版・改定日）をテンプレに標準化。

2.2 Googleスプレッドシート（管理台帳／UI）

推奨シート（列は例）：
	•	Docs
	•	docId | 会議種別 | 会議日 | タイトル | 下書きURL | 申請者 | 期限 | ステータス(集計) | 最終更新 | バージョン
	•	Motions（議案）
	•	docId | 議案番号 | 議案タイトル | 入力HTML | 生成本文 | 添付資料有無 | 添付資料メモ | 生成時刻 | 最終編集者
	•	Approvers（承認者）
	•	docId | approverEmail | 承認状態(PENDING/APPROVED/REJECTED) | 承認日時 | 否認理由 | 最終通知日時
	•	Templates
	•	会議種別 | templateDocId | テンプレ名称 | バージョン | 備考
	•	Config
	•	fromName | replyTo | リマインド間隔(時間) | ドメイン制限（true/false） | 期限前警告(時間) | 監査ログ行き先 | 生成AIプロンプト方針
	•	AuditLog（監査ログ）
	•	日時 | 操作種別 | 実行者 | docId | 詳細 | 成否

2.3 HTML UI（サイドバー／モーダル）
	•	新規ドラフト作成：会議種別（プルダウン）、会議日、タイトル、出席者等、承認者アドレス複数
	•	議案追加：対象ドキュメント選択、議案番号／タイトル、議案案（HTML入力）、AI整形プレビュー、添付有無
	•	承認状況ビュー：承認者リスト、状態、期限、最終通知、ワンクリック承認／却下リンクの再発行
	•	設定：リマインド間隔、期限前警告時間、通知文面テンプレ（件名／本文）、AI方針

⸻

3. 主な業務フロー

3.1 新規ドラフト作成（テンプレ適用）
	1.	シートUIで会議種別を選択 → 2) 対応テンプレからDocs生成
	2.	会議基本情報を差し込み（日時／場所等）
	3.	Approversへ承認者登録（期限含む）
	4.	Docs行に下書きURLを記録、ステータス=「編集中」

3.2 議案の段階追加（議案1→2→3…）
	1.	HTMLフォームに**議案案（HTML）**を入力
	2.	AIで整形・標準文言整備 → プレビュー承認
	3.	Motionsに保存 → Docsの{{MOTIONS_BLOCK}}へ追記挿入（議案番号順）
	4.	添付資料有無を記録（「有」の場合は資料管理の参照パス／保管先をメモ）
	5.	既存ドラフトに何度でも追加できる（追加は逐次方式）

3.3 承認・リマインド
	•	作成時または「承認依頼」操作で初回通知（メール/Chat）。
	•	承認期限の設定（Docs/Approversに保持）。
	•	自動リマインド：
	•	条件：承認状態=PENDING かつ 最終通知日時 + リマインド間隔 ≤ 現在
	•	期限前警告（例：24時間前）を追加通知
	•	承認／却下：リンク経由で即時反映（承認日時、却下理由記録）
	•	ドキュメント反映：{{APPROVALS_TABLE}}へ承認結果を整形出力（氏名/状態/日時/理由）
	•	ステータス集計：全承認済→「承認済」／却下含む→「差戻し」

3.4 最終化・版管理
	•	最終承認後に「最終版」フラグ付与、PDF書き出し（任意）、保管フォルダへ移動。
	•	Docsのバージョン名（会議日_版番号）で履歴管理。
	•	AuditLogへ「確定」記録。

⸻

4. AI整形（議案案 → 標準文案）

4.1 入力
	•	HTML（見出し、箇条書き、表許容）。最低限：議案タイトル／趣旨／背景／決議案／効果発生日。

4.2 出力方針
	•	自社標準の構成に正規化：
	1.	概要 2) 付議の理由（背景）3) 審議事項 4) 決議案（条文体）5) 付記事項 6) 参考資料
	•	用字用語（敬体／常体）を会議種別ポリシーに合わせる（Configで選択）。
	•	文字数・言い回しの平準化（冗長表現の圧縮、重複削除）。

4.3 品質チェック
	•	生成前後の差分プレビュー／強制項目（決議案必須等）のバリデーション。
	•	エッジケース（機密語や社名変種、金額・日付のフォーマット）を辞書（Config内辞書）で統一。
	•	生成失敗・再生成時は元入力を保持。

⸻

5. 承認仕様（トラッカー）

5.1 承認モデル
	•	対象単位：文書単位（docId）。議案ごと個別承認は任意（初期は文書単位推奨）。
	•	状態：PENDING / APPROVED / REJECTED（理由任意）
	•	起点：初回依頼時にApproversへ行追加、期限と初回通知記録。

5.2 通知仕様
	•	チャネル：メール（必須）、Chat/Slack（任意で拡張）、カレンダー保護時間帯ブロック（任意）。
	•	文面テンプレ（Config）：
	•	件名：【承認依頼】{{ドキュメント名}}（期限：{{期限}}）
	•	本文：ドキュメントURL、承認／却下ボタン、期限、問い合わせ先
	•	再通知：リマインド間隔の多重送信防止（最終通知日時で制御）。期限前警告の別テンプレ可。

5.3 Docsへの反映
	•	{{APPROVALS_TABLE}} プレースホルダへ、
| 承認者 | 状態 | 日時 | 否認理由 |
を表形式で出力。更新時は同ブロックを完全置換。

5.4 集計ロジック
	•	全員APPROVED → 文書ステータス=「承認済」
	•	誰かREJECTED → 文書ステータス=「差戻し」＋否認理由表示
	•	期限超過かつPENDINGあり → 文書ステータス=「期限超過（未承認）」、管理者に別途通知

⸻

6. UI/UX 要件
	•	シートメニュー：
	•	ドラフト作成 / 議案追加 / 承認依頼送信 / 承認状況 / 設定 / ログ閲覧
	•	フォーム項目（抜粋）：
	•	ドラフト作成：会議種別、会議日・時刻、議長、出席者、欠席者、承認者、期限
	•	議案追加：対象Doc、議案番号、タイトル、HTML入力、添付有無、AI整形プレビュー
	•	承認依頼：対象Doc、承認者確認、期限、文面確認
	•	バリデーション：会議日必須、承認者メール形式、期限>現在、議案番号ユニーク（doc内）

⸻

7. セキュリティ・コンプライアンス
	•	アクセス：ドメイン内限定共有、Docsは「リンク知っている全員」を禁止。
	•	承認リンク：トークン署名（HMAC想定）、ドメインユーザーのみ有効。期限切れリンク無効化。
	•	監査性：AuditLogに全操作を記録（操作者／時刻／docId／結果）。
	•	機密情報：添付資料の保存場所を定義（機密度でフォルダ分離）。
	•	権限分離：管理者と作成者の機能をUIで明確化。

⸻

8. エラーハンドリング／フォールバック
	•	Docs生成失敗：テンプレ存在・権限・Doc上限をチェックしリトライ案内。
	•	AI整形失敗：元HTMLをそのまま差し込み可能に（手直し運用）。
	•	通知失敗：メール送信キューに再試行、3回失敗で管理者通知。
	•	承認リンク不正：無効画面＋管理者連絡導線。
	•	プレースホルダ未検出：末尾への追記にフォールバック（ログ記録）。

⸻

9. 非機能要件
	•	パフォーマンス：議案差し込みは差分更新（全部書換を避ける）。大量承認者（50名）でも1分内通知。
	•	運用性：Configで文面・間隔・辞書を調整。テンプレの差替はTemplates表のDocId更新で即反映。
	•	拡張性：Chat通知・カレンダー連携・文書個別章ごとの承認（将来）に拡張可能。
	•	多言語：日本語基準、英語テンプレも保持可能（Templatesで言語別テンプレDocId管理）。

⸻

10. 受入基準（UATチェックリスト）
	•	会議種別ごとにテンプレを選んでドラフトが生成される
	•	HTML入力→AI整形→Docs反映の体裁がテンプレ基準に合う
	•	議案2・3…が既存ドラフトに順次追記され、番号順で整列
	•	添付資料「有／無」の記録・表示ができる
	•	承認依頼が全承認者に届く（件名・本文テンプレ通り）
	•	未承認者へリマインドが設定間隔で送付される
	•	承認／却下が即時に台帳とDocsへ反映される（却下理由も）
	•	全承認→「承認済」、却下→「差戻し」、期限超過→「期限超過（未承認）」に自動集計
	•	監査ログに全操作が残る（操作者・時刻・詳細・成否）
	•	権限外ユーザーは機密文書にアクセスできない

⸻

11. ローンチ手順（運用立上げ）
	1.	テンプレ整備（プレースホルダ含む）
	2.	スプレッドシート作成：Docs/Motions/Approvers/Templates/Config/AuditLog
	3.	権限設定（共有先、編集者・閲覧者の分離）
	4.	通知文面・間隔・期限前警告をConfigに設定
	5.	パイロット会議で一連の流れを検証 → 改修 → 全社展開

⸻

12. 将来拡張（任意）
	•	議案単位の承認（個別スコープ）
	•	役職ロールベースの自動承認者割当（取締役変更時のメンテ容易化）
	•	Slack/Google Chat ボタン通知、承認結果のスレッド集計
	•	外部監査向け自動エクスポート（CSV/PDF一括）
	•	書面決議の同意状況トラッキング（同意取得率の自動集計）
