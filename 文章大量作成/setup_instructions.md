# スプレッドシート → Google Docs 自動生成ツール セットアップ手順

## 📋 前提条件

### スプレッドシートの構成
- **A列**: No（連番）
- **B列**: 金額
- **F列**: 会社名・サービス名

### Google Docs テンプレート
以下のプレースホルダーを含むテンプレートを用意してください：
- `{{COMPANY_SERVICE}}` - 会社名・サービス名が挿入される箇所
- `{{Money_Amount}}` - 金額が挿入される箇所

## 🚀 セットアップ手順

### 1. Google Apps Script エディタを開く

1. 対象のGoogleスプレッドシートを開く
2. メニューバーから「拡張機能」→「Apps Script」をクリック
3. 新しいタブでスクリプトエディタが開きます

### 2. スクリプトをコピー

1. 既存のコード（`function myFunction() {}`など）を全て削除
2. `spreadsheet_to_docs.gs` の内容を全てコピー＆ペースト

### 3. 必要なIDを取得・設定

#### テンプレートドキュメントのID取得
1. Google Docs のテンプレートファイルを開く
2. URLから ID を取得
   ```
   https://docs.google.com/document/d/[ここがID]/edit
   ```
3. スクリプトの `TEMPLATE_DOC_ID` に設定

#### 出力フォルダのID取得
1. Google Drive で保存先フォルダを開く
2. URLから ID を取得
   ```
   https://drive.google.com/drive/folders/[ここがID]
   ```
3. スクリプトの `OUTPUT_FOLDER_ID` に設定

### 4. スクリプトの設定を調整

```javascript
// 必要に応じて以下の設定を変更
const SHEET_NAME = 'シート1';  // 対象のシート名
const START_ROW = 2;           // データ開始行（ヘッダーを除く）
```

### 5. スクリプトを保存

1. Ctrl+S（Mac: Cmd+S）で保存
2. プロジェクト名を設定（例：「ドキュメント自動生成」）

### 6. 権限の承認

初回実行時のみ：
1. スクリプトエディタで「実行」ボタンをクリック
2. 「承認が必要です」というダイアログが表示されたら「権限を確認」
3. Googleアカウントを選択
4. 「詳細」→「（安全ではないページ）に移動」をクリック
5. 必要な権限を許可

## 📝 使用方法

### 方法1: メニューバーから実行

1. スプレッドシートをリロード（F5）
2. メニューバーに「ドキュメント生成」が追加される
3. 「ドキュメント生成」→「設定確認」で設定をチェック
4. 「ドキュメント生成」→「テンプレートから生成」で実行

### 方法2: スクリプトエディタから実行

1. Apps Script エディタを開く
2. 関数選択ドロップダウンから選択：
   - `checkSettings`: 設定の確認
   - `testGenerateSingleDocument`: 1件だけテスト生成
   - `generateDocuments`: 全件生成
3. 「実行」ボタンをクリック

## 🎯 生成されるファイル

### ファイル名の形式
```
[No（3桁）]_[会社名・サービス名]
例: 001_株式会社ABC
```

### 置換内容
- `{{COMPANY_SERVICE}}` → F列の値（会社名・サービス名）
- `{{Money_Amount}}` → B列の値（金額、¥マーク付き）

## ⚠️ トラブルシューティング

### エラー: テンプレートドキュメントが見つかりません
- `TEMPLATE_DOC_ID` が正しく設定されているか確認
- テンプレートファイルへのアクセス権限があるか確認

### エラー: 出力フォルダが見つかりません
- `OUTPUT_FOLDER_ID` が正しく設定されているか確認
- フォルダへの書き込み権限があるか確認

### データが生成されない
- スプレッドシートの列設定を確認（F列にデータがあるか）
- `SHEET_NAME` が正しいシート名になっているか確認
- `START_ROW` が正しい開始行になっているか確認

## 💡 カスタマイズのヒント

### 列の変更
異なる列を使用する場合は、以下の定数を変更：
```javascript
const COL_NO = 1;           // A列
const COL_AMOUNT = 2;       // B列
const COL_SERVICE_NAME = 6; // F列
```

### プレースホルダーの追加
新しいプレースホルダーを追加する場合：
1. テンプレートに新しいプレースホルダーを追加（例：`{{DATE}}`）
2. スクリプトに置換処理を追加：
   ```javascript
   replaceText(body, '{{DATE}}', new Date().toLocaleDateString('ja-JP'));
   ```

### 金額フォーマットの変更
`formatCurrency` 関数をカスタマイズして、表示形式を変更できます。